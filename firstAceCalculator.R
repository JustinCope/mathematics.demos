# Mosteller, Frederick, Robert Rourke & George Thomas, Jr. 1970. Probability: A First Course, 2nd Edition. Reading: Addison-Wesley.

# # Displays the probability of drawing the first Ace on the ith card, given that no Aces have been drawn for all lower values of i
# for(i in 0:48){
#      print(i)
#      print(paste("4/",toString(52-i),")=",toString(4/(52-i))))
# }

numerators = seq(48,0,-1)
denominators = seq(52,4,-1)

# columns represent progression through deck
# first row is the number of non-aces in deck, given that no aces have been drawn
# second row is the number of cards remaining in the deck
probabilityMatrixNotAce = mapply(c,numerators,denominators,SIMPLIFY=TRUE)

#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
# [1,]   48   47   46   45   44   43   42   41   40    39    38    37    36    35
# [2,]   52   51   50   49   48   47   46   45   44    43    42    41    40    39
#      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
# [1,]    34    33    32    31    30    29    28    27    26    25    24    23
# [2,]    38    37    36    35    34    33    32    31    30    29    28    27
#      [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
# [1,]    22    21    20    19    18    17    16    15    14    13    12    11
# [2,]    26    25    24    23    22    21    20    19    18    17    16    15
#      [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]
# [1,]    10     9     8     7     6     5     4     3     2     1     0
# [2,]    14    13    12    11    10     9     8     7     6     5     4


for(i in 2:49){
     probabilityMatrixNotAce[,i] <- probabilityMatrixNotAce[,i]*probabilityMatrixNotAce[,i-1]
}

# probabilityMatrixNotAce
#      [,1] [,2]   [,3]    [,4]      [,5]        [,6]         [,7]         [,8]
# [1,]   48 2256 103776 4669920 205476480  8835488640 371090522880 1.521471e+13
# [2,]   52 2652 132600 6497400 311875200 14658134400 674274182400 3.034234e+13
#              [,9]        [,10]        [,11]        [,12]        [,13]
# [1,] 6.085885e+14 2.373495e+16 9.019281e+17 3.337134e+19 1.201368e+21
# [2,] 1.335063e+15 5.740770e+16 2.411124e+18 9.885607e+19 3.954243e+21
#             [,14]        [,15]        [,16]        [,17]        [,18]
# [1,] 4.204789e+22 1.429628e+24 4.717773e+25 1.509687e+27 4.680031e+28
# [2,] 1.542155e+23 5.860188e+24 2.168269e+26 7.805770e+27 2.732019e+29
#             [,19]        [,20]        [,21]        [,22]       [,23]
# [1,] 1.404009e+30 4.071627e+31 1.140056e+33 3.078150e+34 8.00319e+35
# [2,] 9.288866e+30 3.065326e+32 9.809043e+33 3.040803e+35 9.12241e+36
#             [,24]        [,25]        [,26]        [,27]        [,28]
# [1,] 2.000797e+37 4.801914e+38 1.104440e+40 2.429768e+41 5.102514e+42
# [2,] 2.645499e+38 7.407397e+39 1.999997e+41 5.199992e+42 1.299998e+44
#             [,29]        [,30]        [,31]        [,32]        [,33]
# [1,] 1.020503e+44 1.938955e+45 3.490119e+46 5.933203e+47 9.493125e+48
# [2,] 3.119995e+45 7.175990e+46 1.578718e+48 3.315307e+49 6.630614e+50
#             [,34]        [,35]        [,36]        [,37]        [,38]
# [1,] 1.423969e+50 1.993556e+51 2.591623e+52 3.109948e+53 3.420942e+54
# [2,] 1.259817e+52 2.267670e+53 3.855039e+54 6.168063e+55 9.252094e+56
#             [,39]        [,40]        [,41]        [,42]        [,43]
# [1,] 3.420942e+55 3.078848e+56 2.463078e+57 1.724155e+58 1.034493e+59
# [2,] 1.295293e+58 1.683881e+59 2.020657e+60 2.222723e+61 2.222723e+62
#             [,44]        [,45]        [,46]        [,47]        [,48]
# [1,] 5.172465e+59 2.068986e+60 6.206958e+60 1.241392e+61 1.241392e+61
# [2,] 2.000451e+63 1.600361e+64 1.120252e+65 6.721515e+65 3.360757e+66
#             [,49]
# [1,] 0.000000e+00
# [2,] 1.344303e+67


n = rep(4, each=49)
m <- seq(52,4,-1)

# columns represent progression through deck
# first row is the number of aces remaining given that no aces have been previously drawn
# second row is the number of cards remaining in the deck
probabilityMatrixAce<-mapply(c,n,m,SIMPLIFY=TRUE)

# probabilityMatrixAce
#      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
# [1,]    4    4    4    4    4    4    4    4    4     4     4     4     4     4
# [2,]   52   51   50   49   48   47   46   45   44    43    42    41    40    39
#      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
# [1,]     4     4     4     4     4     4     4     4     4     4     4     4
# [2,]    38    37    36    35    34    33    32    31    30    29    28    27
#      [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
# [1,]     4     4     4     4     4     4     4     4     4     4     4     4
# [2,]    26    25    24    23    22    21    20    19    18    17    16    15
#      [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]
# [1,]     4     4     4     4     4     4     4     4     4     4     4
# [2,]    14    13    12    11    10     9     8     7     6     5     4

for(i in 2:49){
     probabilityMatrixAce[,i] <- probabilityMatrixAce[,i]*probabilityMatrixNotAce[,i-1]
}

# probabilityMatrixAce
#      [,1] [,2]   [,3]    [,4]      [,5]        [,6]         [,7]         [,8]
# [1,]    4  192   9024  415104  18679680   821905920  35341954560 1.484362e+12
# [2,]   52 2652 132600 6497400 311875200 14658134400 674274182400 3.034234e+13
#              [,9]        [,10]        [,11]        [,12]        [,13]
# [1,] 6.085885e+13 2.434354e+15 9.493980e+16 3.607712e+18 1.334854e+20
# [2,] 1.335063e+15 5.740770e+16 2.411124e+18 9.885607e+19 3.954243e+21
#             [,14]        [,15]        [,16]        [,17]        [,18]
# [1,] 4.805473e+21 1.681916e+23 5.718513e+24 1.887109e+26 6.038749e+27
# [2,] 1.542155e+23 5.860188e+24 2.168269e+26 7.805770e+27 2.732019e+29
#             [,19]        [,20]        [,21]        [,22]       [,23]
# [1,] 1.872012e+29 5.616037e+30 1.628651e+32 4.560222e+33 1.23126e+35
# [2,] 9.288866e+30 3.065326e+32 9.809043e+33 3.040803e+35 9.12241e+36
#             [,24]        [,25]        [,26]        [,27]        [,28]
# [1,] 3.201276e+36 8.003190e+37 1.920766e+39 4.417761e+40 9.719074e+41
# [2,] 2.645499e+38 7.407397e+39 1.999997e+41 5.199992e+42 1.299998e+44
#             [,29]        [,30]        [,31]        [,32]        [,33]
# [1,] 2.041005e+43 4.082011e+44 7.755821e+45 1.396048e+47 2.373281e+48
# [2,] 3.119995e+45 7.175990e+46 1.578718e+48 3.315307e+49 6.630614e+50
#             [,34]        [,35]        [,36]        [,37]        [,38]
# [1,] 3.797250e+49 5.695875e+50 7.974225e+51 1.036649e+53 1.243979e+54
# [2,] 1.259817e+52 2.267670e+53 3.855039e+54 6.168063e+55 9.252094e+56
#             [,39]        [,40]        [,41]        [,42]        [,43]
# [1,] 1.368377e+55 1.368377e+56 1.231539e+57 9.852314e+57 6.896620e+58
# [2,] 1.295293e+58 1.683881e+59 2.020657e+60 2.222723e+61 2.222723e+62
#             [,44]        [,45]        [,46]        [,47]        [,48]
# [1,] 4.137972e+59 2.068986e+60 8.275944e+60 2.482783e+61 4.965566e+61
# [2,] 2.000451e+63 1.600361e+64 1.120252e+65 6.721515e+65 3.360757e+66
#             [,49]
# [1,] 4.965566e+61
# [2,] 1.344303e+67


newMatrix <- matrix(NA, nrow=3, ncol=49)
newMatrix[1,] <- probabilityMatrixAce[1,]
newMatrix[2,] <- probabilityMatrixAce[2,]

for(i in 1:49){
     newMatrix[3,i] <- newMatrix[1,i]/newMatrix[2,i]
}

# newMatrix
#             [,1]         [,2]        [,3]         [,4]         [,5]
# [1,]  4.00000000 1.920000e+02 9.02400e+03 4.151040e+05 1.867968e+07
# [2,] 52.00000000 2.652000e+03 1.32600e+05 6.497400e+06 3.118752e+08
# [3,]  0.07692308 7.239819e-02 6.80543e-02 6.388771e-02 5.989473e-02
#              [,6]         [,7]         [,8]         [,9]        [,10]
# [1,] 8.219059e+08 3.534195e+10 1.484362e+12 6.085885e+13 2.434354e+15
# [2,] 1.465813e+10 6.742742e+11 3.034234e+13 1.335063e+15 5.740770e+16
# [3,] 5.607166e-02 5.241481e-02 4.892049e-02 4.558500e-02 4.240465e-02
#             [,11]        [,12]        [,13]        [,14]        [,15]
# [1,] 9.493980e+16 3.607712e+18 1.334854e+20 4.805473e+21 1.681916e+23
# [2,] 2.411124e+18 9.885607e+19 3.954243e+21 1.542155e+23 5.860188e+24
# [3,] 3.937575e-02 3.649460e-02 3.375750e-02 3.116077e-02 2.870071e-02
#             [,16]        [,17]        [,18]        [,19]        [,20]
# [1,] 5.718513e+24 1.887109e+26 6.038749e+27 1.872012e+29 5.616037e+30
# [2,] 2.168269e+26 7.805770e+27 2.732019e+29 9.288866e+30 3.065326e+32
# [3,] 2.637363e-02 2.417582e-02 2.210361e-02 2.015329e-02 1.832117e-02
#             [,21]        [,22]        [,23]        [,24]        [,25]
# [1,] 1.628651e+32 4.560222e+33 1.231260e+35 3.201276e+36 8.003190e+37
# [2,] 9.809043e+33 3.040803e+35 9.122410e+36 2.645499e+38 7.407397e+39
# [3,] 1.660356e-02 1.499677e-02 1.349709e-02 1.210084e-02 1.080432e-02
#             [,26]        [,27]        [,28]        [,29]        [,30]
# [1,] 1.920766e+39 4.417761e+40 9.719074e+41 2.041005e+43 4.082011e+44
# [2,] 1.999997e+41 5.199992e+42 1.299998e+44 3.119995e+45 7.175990e+46
# [3,] 9.603842e-03 8.495706e-03 7.476221e-03 6.541694e-03 5.688429e-03
#             [,31]        [,32]        [,33]        [,34]        [,35]
# [1,] 7.755821e+45 1.396048e+47 2.373281e+48 3.797250e+49 5.695875e+50
# [2,] 1.578718e+48 3.315307e+49 6.630614e+50 1.259817e+52 2.267670e+53
# [3,] 4.912734e-03 4.210915e-03 3.579278e-03 3.014129e-03 2.511774e-03
#             [,36]        [,37]        [,38]        [,39]        [,40]
# [1,] 7.974225e+51 1.036649e+53 1.243979e+54 1.368377e+55 1.368377e+56
# [2,] 3.855039e+54 6.168063e+55 9.252094e+56 1.295293e+58 1.683881e+59
# [3,] 2.068520e-03 1.680672e-03 1.344538e-03 1.056423e-03 8.126327e-04
#             [,41]        [,42]        [,43]        [,44]        [,45]
# [1,] 1.231539e+57 9.852314e+57 6.896620e+58 4.137972e+59 2.068986e+60
# [2,] 2.020657e+60 2.222723e+61 2.222723e+62 2.000451e+63 1.600361e+64
# [3,] 6.094746e-04 4.432542e-04 3.102780e-04 2.068520e-04 1.292825e-04
#             [,46]        [,47]        [,48]        [,49]
# [1,] 8.275944e+60 2.482783e+61 4.965566e+61 4.965566e+61
# [2,] 1.120252e+65 6.721515e+65 3.360757e+66 1.344303e+67
# [3,] 7.387570e-05 3.693785e-05 1.477514e-05 3.693785e-06



for(i in 1:49){
newMatrix[3,i] <- newMatrix[3,i]*i
}

# newMatrix
#             [,1]         [,2]         [,3]         [,4]         [,5]
# [1,]  4.00000000  192.0000000 9.024000e+03 4.151040e+05 1.867968e+07
# [2,] 52.00000000 2652.0000000 1.326000e+05 6.497400e+06 3.118752e+08
# [3,]  0.07692308    0.1447964 2.041629e-01 2.555508e-01 2.994736e-01
#              [,6]         [,7]         [,8]         [,9]        [,10]
# [1,] 8.219059e+08 3.534195e+10 1.484362e+12 6.085885e+13 2.434354e+15
# [2,] 1.465813e+10 6.742742e+11 3.034234e+13 1.335063e+15 5.740770e+16
# [3,] 3.364300e-01 3.669037e-01 3.913639e-01 4.102650e-01 4.240465e-01
#             [,11]        [,12]        [,13]        [,14]        [,15]
# [1,] 9.493980e+16 3.607712e+18 1.334854e+20 4.805473e+21 1.681916e+23
# [2,] 2.411124e+18 9.885607e+19 3.954243e+21 1.542155e+23 5.860188e+24
# [3,] 4.331333e-01 4.379352e-01 4.388475e-01 4.362508e-01 4.305107e-01
#             [,16]        [,17]        [,18]        [,19]        [,20]
# [1,] 5.718513e+24 1.887109e+26 6.038749e+27 1.872012e+29 5.616037e+30
# [2,] 2.168269e+26 7.805770e+27 2.732019e+29 9.288866e+30 3.065326e+32
# [3,] 4.219780e-01 4.109890e-01 3.978650e-01 3.829125e-01 3.664235e-01
#             [,21]        [,22]        [,23]        [,24]        [,25]
# [1,] 1.628651e+32 4.560222e+33 1.231260e+35 3.201276e+36 8.003190e+37
# [2,] 9.809043e+33 3.040803e+35 9.122410e+36 2.645499e+38 7.407397e+39
# [3,] 3.486749e-01 3.299289e-01 3.104331e-01 2.904202e-01 2.701080e-01
#             [,26]        [,27]        [,28]        [,29]        [,30]
# [1,] 1.920766e+39 4.417761e+40 9.719074e+41 2.041005e+43 4.082011e+44
# [2,] 1.999997e+41 5.199992e+42 1.299998e+44 3.119995e+45 7.175990e+46
# [3,] 2.496999e-01 2.293841e-01 2.093342e-01 1.897091e-01 1.706529e-01
#             [,31]        [,32]        [,33]        [,34]        [,35]
# [1,] 7.755821e+45 1.396048e+47 2.373281e+48 3.797250e+49 5.695875e+50
# [2,] 1.578718e+48 3.315307e+49 6.630614e+50 1.259817e+52 2.267670e+53
# [3,] 1.522948e-01 1.347493e-01 1.181162e-01 1.024804e-01 8.791209e-02
#             [,36]        [,37]        [,38]        [,39]        [,40]
# [1,] 7.974225e+51 1.036649e+53 1.243979e+54 1.368377e+55 1.368377e+56
# [2,] 3.855039e+54 6.168063e+55 9.252094e+56 1.295293e+58 1.683881e+59
# [3,] 7.446671e-02 6.218487e-02 5.109244e-02 4.120048e-02 3.250531e-02
#             [,41]        [,42]        [,43]        [,44]        [,45]
# [1,] 1.231539e+57 9.852314e+57 6.896620e+58 4.137972e+59 2.068986e+60
# [2,] 2.020657e+60 2.222723e+61 2.222723e+62 2.000451e+63 1.600361e+64
# [3,] 2.498846e-02 1.861668e-02 1.334195e-02 9.101487e-03 5.817712e-03
#             [,46]        [,47]        [,48]        [,49]
# [1,] 8.275944e+60 2.482783e+61 4.965566e+61 4.965566e+61
# [2,] 1.120252e+65 6.721515e+65 3.360757e+66 1.344303e+67
# [3,] 3.398282e-03 1.736079e-03 7.092068e-04 1.809955e-04


sum(newMatrix[3,])
# [1] 10.6
